{% extends 'base.html' %}
{% load static %}

{% block title %}Panel Principal - Taller Mecánico{% endblock %}

{% block extra_head %}
<script>
    // Forzar aplicación del tema en esta página
    document.addEventListener('DOMContentLoaded', function() {
        const saved = localStorage.getItem("theme") || "piedra";
        document.body.className = `theme-${saved}`;
        
        // Aplicar estilos forzados
        const themes = {
            piedra: { bg: "#2a374e", fg: "#e6e6e6", card: "#3c4a6a", muted: "#b0c4de" },
            charcoal: { bg: "#111827", fg: "#e5e7eb", card: "#1f2937", muted: "#cbd5e1" },
            forest: { bg: "#0b3d2e", fg: "#e7f6ef", card: "#124734", muted: "#cce7dd" },
            plum: { bg: "#2c1b3a", fg: "#f0e9f7", card: "#3a2749", muted: "#dbc9ef" },
            cyan: { bg: "#e0f7fa", fg: "#004d40", card: "#ffffff", muted: "#00695c" },
            sand: { bg: "#faf7f0", fg: "#3e2723", card: "#ffffff", muted: "#5d4037" },
            sage: { bg: "#f1f8e9", fg: "#1b5e20", card: "#ffffff", muted: "#2e7d32" },
            sky: { bg: "#e3f2fd", fg: "#0d47a1", card: "#ffffff", muted: "#1565c0" }
        };
        
        const theme = themes[saved] || themes.piedra;
        
        // Aplicar estilos a elementos específicos
        document.body.style.backgroundColor = theme.bg;
        document.body.style.color = theme.fg;
        
        // Aplicar a contenedores
        const containers = document.querySelectorAll('.dashboard-container, .action-card, .stat-card, .pizarra-section');
        containers.forEach(el => {
            el.style.backgroundColor = theme.card;
            el.style.color = theme.fg;
        });
    });
</script>
<style>
    .dashboard-container {
        max-width: 100%;
        margin: 0;
        padding: 0.5rem;
    }
    
    
    .quick-actions {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1rem;
        margin-bottom: 1.5rem;
    }
    
    .action-card {
        background: var(--card-bg);
        border-radius: 15px;
        padding: 1.5rem;
        text-align: center;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        border: 2px solid transparent;
        transition: all 0.3s ease;
        text-decoration: none;
        color: var(--fg);
        position: relative;
        overflow: hidden;
    }
    
    .action-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        border-color: var(--btn-bg);
        color: var(--fg);
        text-decoration: none;
    }
    
    .action-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
        transition: left 0.5s;
    }
    
    .action-card:hover::before {
        left: 100%;
    }
    
    .action-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
        display: block;
    }
    
    .action-title {
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
    }
    
    .action-description {
        font-size: 0.9rem;
        color: var(--muted);
        margin-bottom: 0;
    }
    
    .pizarra-section {
        background: var(--card-bg);
        border-radius: 15px;
        padding: 1.5rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        margin-bottom: 2rem;
    }
    
    .section-title {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 1rem;
        color: var(--fg);
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 0.75rem;
        margin-bottom: 1.5rem;
    }
    
    .stat-card {
        background: var(--card-bg);
        border-radius: 10px;
        padding: 1rem;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        border-left: 4px solid var(--btn-bg);
    }
    
    .stat-number {
        font-size: 2rem;
        font-weight: bold;
        color: var(--btn-bg);
        margin-bottom: 0.25rem;
    }
    
    .stat-label {
        font-size: 0.9rem;
        color: var(--muted);
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    @media (max-width: 768px) {
        .quick-actions {
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        .action-card {
            padding: 1rem;
        }
        
        .action-icon {
            font-size: 2.5rem;
        }
        
        .stats-grid {
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
        }
        
        .stat-card {
            padding: 0.75rem;
        }
        
        .stat-number {
            font-size: 1.5rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">

    <!-- Estadísticas Rápidas -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-number">📋</div>
            <div class="stat-label">Pizarra Activa</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">🛒</div>
            <div class="stat-label">POS Disponible</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">⚙️</div>
            <div class="stat-label">Administración</div>
        </div>
        <div class="stat-card">
            <div class="stat-number">📊</div>
            <div class="stat-label">Reportes</div>
        </div>
    </div>

    <!-- Acciones Principales -->
    <div class="quick-actions">
        <a href="{% url 'pizarra' %}" class="action-card">
            <span class="action-icon">📋</span>
            <div class="action-title">Pizarra de Trabajos</div>
            <div class="action-description">Gestiona el estado de todos los trabajos en curso</div>
        </a>
        
        <a href="{% url 'pos_principal' %}" class="action-card">
            <span class="action-icon">🛒</span>
            <div class="action-title">Punto de Venta</div>
            <div class="action-description">Ventas y cotizaciones de repuestos</div>
        </a>
        
        <a href="{% url 'ingreso' %}" class="action-card">
            <span class="action-icon">📝</span>
            <div class="action-title">Nuevo Diagnóstico</div>
            <div class="action-description">Registra un nuevo diagnóstico de vehículo</div>
        </a>
        
        <a href="{% url 'lista_diagnosticos' %}" class="action-card">
            <span class="action-icon">🔍</span>
            <div class="action-title">Ver Diagnósticos</div>
            <div class="action-description">Consulta y gestiona diagnósticos existentes</div>
        </a>
    </div>

    <!-- Pizarra Integrada -->
    <div class="pizarra-section">
        <h2 class="section-title">
            📋 Pizarra de Trabajos
        </h2>
        {% include "car/pizarra_partial.html" %}
    </div>

    <!-- Acciones Secundarias -->
    <div class="quick-actions">
        <a href="{% url 'lista_trabajos' %}" class="action-card">
            <span class="action-icon">🚗</span>
            <div class="action-title">Trabajos en Curso</div>
            <div class="action-description">Gestiona trabajos activos</div>
        </a>
        
        <a href="{% url 'pos_historial_ventas' %}" class="action-card">
            <span class="action-icon">📊</span>
            <div class="action-title">Historial de Ventas</div>
            <div class="action-description">Consulta ventas realizadas</div>
        </a>
        
        <a href="{% url 'pos_historial_cotizaciones' %}" class="action-card">
            <span class="action-icon">📋</span>
            <div class="action-title">Cotizaciones</div>
            <div class="action-description">Gestiona cotizaciones pendientes</div>
        </a>
        
        <a href="{% url 'cliente_list' %}" class="action-card">
            <span class="action-icon">👤</span>
            <div class="action-title">Clientes</div>
            <div class="action-description">Base de datos de clientes</div>
        </a>
        
        <a href="{% url 'compra_dashboard' %}" class="action-card">
            <span class="action-icon">🛒</span>
            <div class="action-title">Compras</div>
            <div class="action-description">Gestiona compras de repuestos</div>
        </a>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Animaciones para las tarjetas
document.addEventListener('DOMContentLoaded', function() {
    const actionCards = document.querySelectorAll('.action-card');
    
    actionCards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.6s ease';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 100);
    });
    
    // Animación para las estadísticas
    const statCards = document.querySelectorAll('.stat-card');
    
    statCards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'scale(0.8)';
        
        setTimeout(() => {
            card.style.transition = 'all 0.4s ease';
            card.style.opacity = '1';
            card.style.transform = 'scale(1)';
        }, index * 50);
    });
});

// Efecto de hover mejorado
document.querySelectorAll('.action-card').forEach(card => {
    card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-8px) scale(1.02)';
    });
    
    card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0) scale(1)';
    });
});
</script>
{% endblock %}